{% extends "classes/base_class.html" %}

{% block class_content %}
{% if user_role == 'TEACHER' %}
<ul class="nav nav-tabs nav-justified">
    <li role="presentation"><a href="{%url 'school:classlist' %}">View Classes</a></li>
    <li role="presentation"><a href="{%url 'school:classassignment' %}">Assignments</a></li>
    <li role="presentation"><a href="{%url 'school:classattendance' %}">Attendance</a></li>
    <li role="presentation" class="active"><a href="{%url 'school:classperformance' %}">Grading</a></li>
    <li role="presentation"><a href="{%url 'school:classreportcard' %}">Report Card</a></li>
</ul>
{%else%}
<ul class="nav nav-tabs nav-justified">
    <li role="presentation"><a href="{%url 'school:classlist' %}">View Classes</a></li>
    <li role="presentation"><a href="{%url 'school:classcreate' %}">Add Class</a></li>
    <li role="presentation"><a href="{%url 'school:classregistration' %}">Class Registration</a></li>
    <li role="presentation"><a href="{%url 'school:classassignment' %}">Assignments</a></li>
    <li role="presentation"><a href="{%url 'school:classattendance' %}">Attendance</a></li>
    <li role="presentation" class="active"><a href="{%url 'school:classperformance' %}">Grading</a></li>
    <li role="presentation"><a href="{%url 'school:classreportcard' %}">Report Card</a></li>
</ul>
{%endif%}

  <div class="row">  
                 <div class="col-lg-12">
                        <h1 class="page-header">
                            Classes<small> Grading</small>
                        </h1>
                        <ol class="breadcrumb">
                            <li class="active">
                                <i class="fa fa-sitemap"></i> <a> Classes > Grading</a>
                            </li>
                        </ol>

                    </div>

<div class="col-md-3">
{% if class_list %}
<div class="list-group">
    {% for class_ in class_list %}
      {% if class_ = class %}
        <a href="{% url 'school:classperformance' class_.id %}" class="list-group-item active">
           {{ class_.course }} {{ class_.section }}
        </a>
      {% else %}
        <a href="{% url 'school:classperformance' class_.id %}" class="list-group-item">
           {{ class_.course }} {{ class_.section }}
        </a>
      {% endif %}
    {% endfor %}
</div>
{% else %}
    <div class="alert alert-info" role="alert">No classes have been added.</div>
{% endif %}
</div>

<div class="col-md-8">
{% if class %}

{% if succ %}
  <div class="alert alert-success" role="alert"> Grades were edited successfully. </div>
  {% endif %}
  
    {% if errors %}
    <div class="panel panel-danger">
      {%for dict in errors%}
		{%for error in dict.values %}
			{{error}}
		{%endfor%}
	  {%endfor%}
    </div>
  {% endif %}
  
  <div class='col-md-4'>

{% if assignment %}
<div class="dropdown">
  <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
    {{assignment.title}}
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
    {% for a in assignment_list %}
    {% if a != assignment%}
    <li role="presentation"><a role="menuitem" tabindex="-1" href="{% url 'school:classperformance' class.id a.id %}">{{a.title}}</a></li>
    {%endif%}
    {% endfor %}
  </ul>
</div>
</div>
{%else%}
{%if assignment_list|length != 0 %}
<div class="dropdown">
  <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
    Assignment
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">

    {% for a in assignment_list %}
    <li role="presentation"><a role="menuitem" tabindex="-1" href="{% url 'school:classperformance' class.id a.id %}">{{a.title}}</a></li>
    {% endfor %}
  </ul>
</div>
{%else%}
</div>
  <div class="alert alert-info" role="alert"> No assignments to list. Add Assignments for grading. </div>
{% endif %} <!-- assignment list -->
{% endif %}

{% if assignment %}
<div class="col-md-12">
  <h4>Assignment Grades</h4>

  <div class="table-responsive">


<form role="form" action="{%url 'school:classperformance' class.id assignment.id %}" method="post" enctype="multipart/form-data">

    {% csrf_token %}
    {{ formset.management_form }}
                
    <table id="mytable" class="table table-bordred table-striped">
         
         <thead>
        
         <th>Name</th>
         <th>Weight</th>
         <th>Grade</th>
         <th>Total points</th>
           <th>Comments</th>
         </thead>
    <tbody>
      {% for form in formset.forms %}

    <tr>
    {{form.id}}

    <td>
       {{ form.student.as_hidden }}
    {% for q in classregistration %}
    {%if q.student.id == form.student.value %}
    {{q.student.first_name}} {{q.student.last_name}}
    {%endif%}
    {%endfor%}
    </td>
    <td>{{assignment.grade_weight}}%</td>
    <td>
    <div class="input-group" style="width: 50px;">
    {{ form.grade }}
    </div>
    </td>
     <td>/{{assignment.total_weight}}</td>
    <td>
    <div class="input-group" style="width: 100px;">
    {{ form.comments }}
    </div>
    </td>
    <td>{{form.reg_class.as_hidden}}</td>
    </tr>
       
    {% endfor %}
    </tbody>
</table>

    <input type="submit" class="btn btn-primary pull-right" value="Save" />
 
</form>



    </div>
    </div>

{% endif %}
{% else %}
  {% if class_list %}
        <div class="alert alert-info" role="alert">
            Select a class to view grades.
        </div>
    {% endif %}
{% endif %}

</div>


{% endblock class_content %}