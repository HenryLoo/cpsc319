{% extends "classes/base_class.html" %}

{% block current_tab %}
  "Create Class"
{% endblock %}


{% block class_content %}
{% if user_role == 'TEACHER' %}
<ul class="nav nav-tabs nav-justified">
    <li role="presentation"><a href="{%url 'school:classlist' %}">View Classes</a></li>
    <li role="presentation"><a href="{%url 'school:classassignment' %}">Assignments</a></li>
    <li role="presentation" class="active"><a href="{%url 'school:classattendance' %}">Attendance</a></li>
    <li role="presentation"><a href="{%url 'school:classperformance' %}">Grading</a></li>
    <li role="presentation"><a href="{%url 'school:classreportcard' %}">Report Card</a></li>
</ul>
{%else%}
<ul class="nav nav-tabs nav-justified">
    <li role="presentation"><a href="{%url 'school:classlist' %}">View Classes</a></li>
    <li role="presentation"><a href="{%url 'school:classcreate' %}">Add Class</a></li>
    <li role="presentation"><a href="{%url 'school:classregistration' %}">Class Registration</a></li>
    <li role="presentation"><a href="{%url 'school:classassignment' %}">Assignments</a></li>
    <li role="presentation" class="active"><a href="{%url 'school:classattendance' %}">Attendance</a></li>
    <li role="presentation"><a href="{%url 'school:classperformance' %}">Grading</a></li>
    <li role="presentation"><a href="{%url 'school:classreportcard' %}">Report Card</a></li>
</ul>
{%endif%}

  <div class="row">  
                 <div class="col-lg-12">
                        <h1 class="page-header">
                            Classes<small> Attendance</small>
                        </h1>
                        <ol class="breadcrumb">
                            <li class="active">
                                <i class="fa fa-sitemap"></i> <a> Classes > Attendance</a>
                            </li>
                        </ol>

                    </div>


<div class="col-md-3">
{% if class_list %}
<div class="list-group">
    {% for class_ in class_list %}
        {% if class_ = class %}
        <a href="{% url 'school:classattendance' class_.id %}" class="list-group-item active">
           {{ class_.course }} {{ class_.section }}
        </a>
        {% else %}
          <a href="{% url 'school:classattendance' class_.id %}" class="list-group-item">
           {{ class_.course }} {{ class_.section }}
          </a>
        {% endif %}
    {% endfor %}
</div>
{% else %}
    <div class="alert alert-info" role="alert">No classes have been added.</div>
{% endif %}
</div>
        <div class="col-md-8">

{% if class %}

{% if success %}
  <div class="alert alert-success" role="alert"> {{success}} </div>
{% endif %}

{% if errors %}
  <div class="alert alert-danger" role="alert"> {{ errors }} </div>
{% endif %}

{% if date_errors %}
  <div class="alert alert-danger" role="alert"> Select a date </div>
{% endif %}

<form role="form" id="attendance-form"action="{%url 'school:classattendance' class.id %}" method="post" enctype="multipart/form-data">

            <!-- Tab panes -->
    <div class="tab-pane fade in" id="Attendance">
        <div class='col-md-4'>
          <div class='row'>
            {% csrf_token %}
            {{ dateform }}
           <td><input type="submit" value="OK" name="_date"></td>   
          </div>
        </div>
        
    </div>


{% if date_value %}
    <div class="col-md-12">
        <h4>Class Attendance</h4>
        <div class="table-responsive">

    {% csrf_token %}
    {{ formset.management_form }}  

    <table id="mytable" class="table table-bordred table-striped">                 
       <thead>     
       <th>Name</th>
         <th>Attendance</th>
         <th>Comments</th>
       </thead>
      <tbody>    

     {% for form in formset %}

    <tr>
    {{form.id}}
    <td> 
      
    {{ form.student.as_hidden }}
    {% for q in querylist %}
    {%if q.student.id == form.student.value %}
    {{q.student.first_name}} {{q.student.last_name}}
    {%endif%}
    {%endfor%}
    </td>
    <td>
    <div class="input-group" style="width: 50px;">
    {{ form.attendance }}

    </div>
    </td>
    <td>
    <div class="input-group" style="width: 100px;">
    {{ form.comments }}
    </div>
    </td>
    <td>{{form.reg_class.as_hidden}}</td>
    </tr>
       
    {% endfor %}
     </tbody>
    </table>


      <input type="submit" class="btn btn-primary pull-right" value="Save" name="_attendance"/>
     
  </form>           
  </div>
            
        </div>
    </div>
</div>

{%endif%}
{% else %}

  {% if class_list %}
      <div class="alert alert-info" role="alert">
          Select a class to view attendance.
      </div>
  {% endif %}
{% endif %}

{% endblock class_content %}